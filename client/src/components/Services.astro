---
import { fetchAPI } from "../lib/api.js";
import { servicesDefaults } from "../lib/constants.js";
import * as LucideIcons from "@lucide/astro";

const data = await fetchAPI("services-page?populate=services");

let title = servicesDefaults.title;
let description = servicesDefaults.description;
let services = [];

if (data?.data?.attributes) {
  const attrs = data.data.attributes;
  title = attrs.title || title;
  description = attrs.description || description;
  services = attrs.services || [];
}
---

<section id="services" class="py-16 bg-gray-100 text-gray-700">
  <div
    class="flex flex-col justify-center text-center max-w-4xl mx-auto px-4"
    data-aos="slide-left"
    data-aos-duration="750"
    data-aos-once="true"
  >
    <h2 class="text-3xl text-center mb-8">{title}</h2>
    {description && <p class="text-lg mb-8">{description}</p>}
    
    {services.length > 0 && (
      <ul class="pl-6 bg-white mx-auto p-8 rounded-xl shadow-xl hover:scale-105 transition-transform duration-500">
        {services.map((service) => {
          const IconComponent = LucideIcons[service.icon] || LucideIcons.CheckCircle;
          return (
            <li class="mb-4 flex items-start text-left gap-3">
              <IconComponent class="w-6 h-6 text-primary flex-shrink-0 mt-1" />
              <div>
                <h3 class="font-semibold text-lg">{service.title}</h3>
                {service.description && <p class="text-gray-600">{service.description}</p>}
              </div>
            </li>
          );
        })}
      </ul>
    )}
  </div>
</section>
