---
import Layout from "../../layouts/DefaultLayout.astro";
const apiUrl = import.meta.env.API_URL;

const response = await fetch(`${apiUrl}/api/documents?populate=file`);

const { data } = await response.json();

const documents = data.map((document) => {
	return {
		id: document.id,
		title: document.attributes.title,
		description: document.attributes.description,
		fileName: document.attributes.file.data.attributes.name,
		fileUrl: document.attributes.file.data.attributes.url,
	};
});
---

<Layout title="publications">
	<section id="publications">
		<div class="text-center mb-12">
			<h1 class="text-3xl font-semibold text-center text-primary">
				Publications
			</h1>
			<p class="text-gray-500 mt-1">
				These are publications of relevent documents
			</p>
		</div>
		<div class="flex justify-center">
			<ul class="w-full max-w-4xl space-y-4 px-4">
				{
					documents.map((document) => (
						<li class="card bg-base-100 shadow-lg border border-neutral rounded-lg">
							<a href={`/publications/${document.id}`} class="no-underline">
								<div class="card-body p-6">
									<h2 class="text-2xl font-semibold text-primary mb-2">
										{document.title}
									</h2>
									<p class="text-gray-600">{document.description}</p>
									<a
										href={apiUrl + document.fileUrl}
										class="btn btn-primary text-white mt-4"
									>
										Download
									</a>
								</div>
							</a>
						</li>
					))
				}
			</ul>
		</div>
	</section>
</Layout>
